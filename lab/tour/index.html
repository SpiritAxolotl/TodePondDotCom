<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<script
  data-goatcounter="https://todepond.goatcounter.com/count"
  async
  src="//gc.zgo.at/count.js"></script>
<title>Tadi lab</title>
<link rel="shortcut icon" href="/favicon.png" />
<meta property="og:image" content="https://todepond.com/lab/og.png" />
<meta property="og:title" content="Tadi lab" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Tadi lab" />
<meta name="twitter:description" content="" />
<meta name="twitter:image" content="https://todepond.com/lab/og.png" />

<link rel="stylesheet" href="/style.css" />

<!-- <h1>Frame</h1> -->

<!-- <input type="url" value="https://todepond.com/" /> -->

<style>
  * {
    box-sizing: border-box;
  }

  #frame {
    width: 100%;
  }

  iframe {
    width: 100%;
    height: 100%;
    /* background-color: white; */
    border: none;
  }

  body {
    width: 100%;
    max-width: 100%;
    padding: 0;
  }
</style>

<!-- <article id="frame"> -->
<iframe src="/" title="todepond"></iframe>
<!-- </article> -->

<script type="module">
  const slides = [
    "/lab/tour/welcome/",
    "/lab/vector/",
    "/",
    "/wikiblogarden/",
    "/feed/maker/",
    "/pondcast/feed/maker/",
    "/fame/dashboard/",
    "/lab/",
    "/lab/counter/",
    "https://todepond-getcounterhistorytwo.web.val.run/",
    "/lab/leave/",
    "/lab/locker/",
    "/lab/login/",
    "/lab/emphasis/",
    "/lab/video/",
    "/pay/",
    "/lab/code/",
    "/lab/bootstrap/",
    "/lab/browse/",
    "/lab/tool/",
    "/lab/toooooool/",
    "/lab/spin/",
    "/lab/connect/",
    "/lab/same/",
    "https://drawdeadfish.com/",
  ];

  const localStorageStartingSlide =
    localStorage.getItem("/lab/tour/startingSlide") ?? "/";

  const startingSlide = slides.includes(localStorageStartingSlide)
    ? localStorageStartingSlide
    : "/";

  const iframe = document.querySelector("iframe");

  let currentSlide = startingSlide;
  let currentSlideIndex = slides.indexOf(currentSlide);
  iframe.src = currentSlide;

  function handleKeyDown(e, _window = window) {
    const activeElement = _window.document.activeElement;
    if (
      activeElement.tagName === "INPUT" ||
      activeElement.tagName === "TEXTAREA"
    ) {
      return;
    }

    switch (e.key) {
      case "ArrowLeft": {
        currentSlideIndex = Math.max(0, currentSlideIndex - 1);
        break;
      }
      case "ArrowRight": {
        currentSlideIndex = Math.min(slides.length - 1, currentSlideIndex + 1);
        break;
      }
      default: {
        return;
      }
    }

    if (currentSlideIndex === slides.indexOf(currentSlide)) {
      return;
    }
    const slide = slides[currentSlideIndex];
    iframe.src = slide;
    currentSlide = slide;
    localStorage.setItem("/lab/tour/startingSlide", currentSlide);
  }

  addEventListener("keydown", handleKeyDown);

  iframe.addEventListener("load", () => {
    iframe.contentWindow.addEventListener("keydown", (e) =>
      handleKeyDown(e, iframe.contentWindow)
    );
  });
</script>
